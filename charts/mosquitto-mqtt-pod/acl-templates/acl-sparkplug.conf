# ============================================================================
# Sparkplug B ACL Configuration
# For Eclipse Mosquitto MQTT Broker
# ============================================================================
#
# Sparkplug B Topic Structure:
#   spBv1.0/<group_id>/<message_type>/<edge_node_id>[/<device_id>]
#
# Message Types:
#   NBIRTH  - Edge Node birth certificate
#   NDEATH  - Edge Node death certificate (LWT)
#   DBIRTH  - Device birth certificate  
#   DDEATH  - Device death certificate
#   NDATA   - Edge Node data
#   DDATA   - Device data
#   NCMD    - Node command
#   DCMD    - Device command
#   STATE   - Primary application state
# ============================================================================

# =============================================================
# Admin User - Full Access
# =============================================================
user admin
topic readwrite #

# =============================================================
# Primary Application (SCADA/Ignition/etc.)
# =============================================================
user primary_application
# Read all Sparkplug B messages
topic read spBv1.0/#
# Write commands to all edge nodes and devices
topic write spBv1.0/+/NCMD/#
topic write spBv1.0/+/DCMD/#
# Write STATE messages (primary app lifecycle)
topic write STATE/#

# =============================================================
# Edge Node: Factory Group
# =============================================================
user edge_factory_01
# Node birth/death/data
topic write spBv1.0/Factory/NBIRTH/edge_factory_01
topic write spBv1.0/Factory/NDEATH/edge_factory_01
topic write spBv1.0/Factory/NDATA/edge_factory_01
# Device birth/death/data (all devices under this edge node)
topic write spBv1.0/Factory/DBIRTH/edge_factory_01/#
topic write spBv1.0/Factory/DDEATH/edge_factory_01/#
topic write spBv1.0/Factory/DDATA/edge_factory_01/#
# Read commands for this edge node
topic read spBv1.0/Factory/NCMD/edge_factory_01
topic read spBv1.0/Factory/DCMD/edge_factory_01/#
# Read STATE for primary app status
topic read STATE/#

# =============================================================
# Edge Node: Warehouse Group
# =============================================================
user edge_warehouse_01
topic write spBv1.0/Warehouse/NBIRTH/edge_warehouse_01
topic write spBv1.0/Warehouse/NDEATH/edge_warehouse_01
topic write spBv1.0/Warehouse/NDATA/edge_warehouse_01
topic write spBv1.0/Warehouse/DBIRTH/edge_warehouse_01/#
topic write spBv1.0/Warehouse/DDEATH/edge_warehouse_01/#
topic write spBv1.0/Warehouse/DDATA/edge_warehouse_01/#
topic read spBv1.0/Warehouse/NCMD/edge_warehouse_01
topic read spBv1.0/Warehouse/DCMD/edge_warehouse_01/#
topic read STATE/#

# =============================================================
# Historian / Data Logger - Read-Only
# =============================================================
user historian
topic read spBv1.0/#
topic read STATE/#

# =============================================================
# Pattern-Based Edge Node Access
# Requires edge node usernames in format: edge_<group>_<node_id>
# =============================================================
# This would require custom authentication plugin
# Example for future use:
# pattern write spBv1.0/%g/NBIRTH/%n
# pattern write spBv1.0/%g/NDEATH/%n
# pattern write spBv1.0/%g/NDATA/%n
# pattern write spBv1.0/%g/DBIRTH/%n/#
# pattern write spBv1.0/%g/DDEATH/%n/#
# pattern write spBv1.0/%g/DDATA/%n/#
# pattern read spBv1.0/%g/NCMD/%n
# pattern read spBv1.0/%g/DCMD/%n/#

# =============================================================
# Monitoring Systems - Read-Only
# =============================================================
user monitoring
topic read spBv1.0/#

# =============================================================
# Deny All Other Users (if using default allow)
# =============================================================
# If you have allow_anonymous true, add this to deny unlisted users:
# user anonymous
# topic deny #
