# ============================================================================
# Factory Floor ACL Configuration
# For Eclipse Mosquitto MQTT Broker
# ============================================================================
#
# Topic Structure:
#   factory/<area>/<equipment>/<metric>
#   sensors/<sensor_id>/<measurement>
#   commands/<target>/<action>
#   alarms/<severity>/<source>
#   status/<system>
# ============================================================================

# =============================================================
# Admin - Full Access
# =============================================================
user admin
topic readwrite #

# =============================================================
# SCADA System - Read All Sensors, Write Commands
# =============================================================
user scada
# Read all factory data
topic read factory/#
topic read sensors/#
topic read alarms/#
topic read status/#
# Write commands to equipment
topic write commands/#
# Write status updates
topic write status/scada

# =============================================================
# HMI Operators - Read Data, Limited Commands
# =============================================================
user operator
# Read factory floor data
topic read factory/#
topic read sensors/#
topic read alarms/#
# Write limited commands
topic write commands/conveyor/#
topic write commands/ack_alarm/#

# =============================================================
# PLCs - Publish Data, Receive Commands
# =============================================================
user plc_line01
topic write factory/line01/#
topic write sensors/line01/#
topic write alarms/+/line01
topic write status/plc_line01
topic read commands/line01/#

user plc_line02
topic write factory/line02/#
topic write sensors/line02/#
topic write alarms/+/line02
topic write status/plc_line02
topic read commands/line02/#

user plc_packaging
topic write factory/packaging/#
topic write sensors/packaging/#
topic write alarms/+/packaging
topic write status/plc_packaging
topic read commands/packaging/#

# =============================================================
# Sensor Gateways - Publish Sensor Data
# =============================================================
user sensor_gateway_01
topic write sensors/gateway01/#
topic write status/sensor_gateway_01

user sensor_gateway_02
topic write sensors/gateway02/#
topic write status/sensor_gateway_02

# Pattern-based sensor access (username = sensor_<id>)
pattern write sensors/%u/#
pattern write status/%u

# =============================================================
# Edge Devices - Specific Topics
# =============================================================
user temperature_sensor_01
topic write sensors/temperature/zone01
topic write status/temperature_sensor_01

user pressure_sensor_01
topic write sensors/pressure/line01
topic write status/pressure_sensor_01

user vibration_monitor_01
topic write sensors/vibration/pump01
topic write alarms/warning/vibration_monitor_01
topic write status/vibration_monitor_01

# =============================================================
# Historian / Database Writer - Read-Only
# =============================================================
user historian
topic read factory/#
topic read sensors/#
topic read alarms/#
topic read status/#

# =============================================================
# Monitoring & Analytics - Read-Only
# =============================================================
user analytics
topic read factory/#
topic read sensors/#

# =============================================================
# Maintenance System - Read Status, Write Maintenance Topics
# =============================================================
user maintenance
topic read factory/#
topic read sensors/#
topic read alarms/#
topic read status/#
topic write maintenance/#
topic write commands/maintenance/#

# =============================================================
# Quality Control - Read Product Data
# =============================================================
user quality_control
topic read factory/+/quality/#
topic read sensors/+/quality/#
topic write quality/#

# =============================================================
# Energy Management - Read Power/Energy Data
# =============================================================
user energy_manager
topic read factory/+/energy/#
topic read sensors/+/power/#
topic read sensors/+/energy/#
topic write energy/#

# =============================================================
# Safety System - Priority Alarms and Shutdowns
# =============================================================
user safety_system
topic readwrite alarms/critical/#
topic readwrite alarms/emergency/#
topic write commands/emergency_stop/#
topic read factory/#

# =============================================================
# External Integration - Limited Cloud Sync
# =============================================================
user cloud_bridge
topic read factory/summary/#
topic read sensors/summary/#
topic read status/#

# =============================================================
# Deny Pattern for Unknown Users
# =============================================================
# Uncomment if you want to explicitly deny all undefined users
# user undefined
# topic deny #
