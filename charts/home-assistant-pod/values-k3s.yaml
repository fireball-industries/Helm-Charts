# ============================================================================
# Example Values - K3s Single Node
# ============================================================================
# Fireball Industries - Patrick Ryan
# Optimized for K3s on a single node (Raspberry Pi, NUC, etc.)
# ============================================================================

global:
  timezone: "America/New_York"  # CHANGE THIS

homeassistant:
  image:
    repository: ghcr.io/home-assistant/home-assistant
    tag: "2024.12.0"
    pullPolicy: IfNotPresent

  # Moderate resources for single node
  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 2000m
      memory: 4Gi

  # Use host network for mDNS discovery
  hostNetwork: false  # Set to true if you need mDNS/Chromecast discovery

# NodePort service (no LoadBalancer on most K3s setups)
service:
  main:
    type: NodePort
    port: 8123
    nodePort: 30123  # Access at http://<node-ip>:30123

# No ingress (access via NodePort)
ingress:
  enabled: false

# SQLite database (simple, no external DB needed)
database:
  type: sqlite

# Storage using local-path (default K3s provisioner)
persistence:
  config:
    enabled: true
    storageClass: "local-path"
    size: 10Gi
  
  media:
    enabled: true
    storageClass: "local-path"
    size: 20Gi
  
  share:
    enabled: true
    storageClass: "local-path"
    size: 5Gi
  
  backups:
    enabled: true
    storageClass: "local-path"
    size: 10Gi

# MQTT Broker (sidecar)
mqtt:
  enabled: true
  deployment: sidecar
  config:
    allowAnonymous: false
    username: "mqtt"
    password: "CHANGE-ME-K3S"  # CHANGE THIS!
  persistence:
    enabled: true
    storageClass: "local-path"
    size: 1Gi
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 256Mi

# Node-RED (lightweight)
nodered:
  enabled: true
  deployment: sidecar
  persistence:
    enabled: true
    storageClass: "local-path"
    size: 1Gi
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

# ESPHome
esphome:
  enabled: true
  deployment: sidecar
  persistence:
    enabled: true
    storageClass: "local-path"
    size: 2Gi
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 1000m
      memory: 1Gi

# Zigbee2MQTT (if USB device is available)
zigbee2mqtt:
  enabled: false  # Set to true if you have USB Zigbee coordinator
  deployment: sidecar
  usbDevice: "/dev/ttyACM0"  # Common for Raspberry Pi
  persistence:
    enabled: true
    storageClass: "local-path"
    size: 1Gi

# No monitoring (save resources)
monitoring:
  serviceMonitor:
    enabled: false
  grafanaDashboard:
    enabled: false

# No network policies (simpler setup)
networkPolicy:
  enabled: false
