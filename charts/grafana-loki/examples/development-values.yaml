# Development Grafana + Loki Deployment Example
# Minimal resources for local development and testing

namespace:
  name: grafana-loki-dev
  create: true

pod:
  replicaCount: 1

# Grafana Configuration
grafana:
  enabled: true
  
  image:
    repository: grafana/grafana
    tag: "10.2.3"
    pullPolicy: Always  # Pull latest for dev
  
  admin:
    user: "admin"
    password: "admin"  # Simple password for dev (NOT FOR PRODUCTION)
  
  config:
    plugins: ""  # No extra plugins for dev
    log:
      level: "debug"  # Verbose logging for debugging
  
  resources:
    preset: small  # Minimal resources
  
  persistence:
    enabled: true
    storageClass: ""  # Use default
    size: "5Gi"

# Loki Configuration
loki:
  enabled: true
  
  image:
    repository: grafana/loki
    tag: "2.9.3"
    pullPolicy: Always
  
  config:
    server:
      logLevel: "debug"
    
    limits:
      # Relaxed limits for dev
      ingestionRateMb: 5
      ingestionBurstSizeMb: 10
      maxGlobalStreamsPerUser: 5000
      
      # Short retention for dev
      retentionPeriod: "168h"  # 7 days
      maxQueryLookback: "168h"
      
      # Standard query limits
      maxQuerySeries: 500
      maxEntriesLimitPerQuery: 5000
    
    compactor:
      enabled: true
      compactionInterval: "30m"  # Less frequent
      retentionEnabled: true
  
  resources:
    preset: small  # Minimal resources
  
  persistence:
    enabled: true
    storageClass: ""  # Use default
    size: "10Gi"  # Small for short retention

# Service Configuration
service:
  grafana:
    type: NodePort  # Easy local access
    nodePort: 30300  # Fixed port for dev
  
  loki:
    type: ClusterIP

# Ingress - Disabled for dev
ingress:
  enabled: false

# No special node placement for dev
nodeSelector: {}
tolerations: []
affinity: {}

# Monitoring - Disabled for dev
monitoring:
  enabled: false

# No PDB for dev
podDisruptionBudget:
  enabled: false

# No network policies for dev
networkPolicy:
  enabled: false

# Quick Access (after deployment):
# - Grafana: http://<NODE_IP>:30300
# - Username: admin
# - Password: admin
# - Loki datasource: Pre-configured and ready
#
# Send test logs:
# curl -H "Content-Type: application/json" \
#   -XPOST "http://localhost:3100/loki/api/v1/push" \
#   --data '{"streams": [{"stream": {"job": "test"}, "values": [["'$(date +%s)000000000'", "test log message"]]}]}'
